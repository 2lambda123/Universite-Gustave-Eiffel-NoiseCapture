<!DOCTYPE html>
<html>
<head>

    <title>Result map</title>

    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="style/leaflet.css"/>
    <link rel="stylesheet" href="style/style.css"/>
    <script src="js/leaflet.js"></script>

    <style>
		#map {
			width: 600px;
			height: 400px;
		}

    </style>

    <style>body { padding: 0; margin: 0; } html, body, #map { height: 100vh; width: 100vw; }</style>
</head>
<body>

<div id='map'></div>

<script>
	var map = L.map('map').fitWorld();

	L.control.scale({
		'position': 'bottomright',
		'metric': true,
		'imperial': false
	}).addTo(map);

	var userMeasurementPoints = L.featureGroup();

    function addMeasurementPoint(loc, color) {
		userMeasurementPoints.addLayer(L.circleMarker(loc, {
			color: '#ffffff',
			fillColor: color,
			weight: 0.,
			fillOpacity: 1.,
			radius: 2,
			stroke: false,
        	zIndex: 4
			}));
    }

    userMeasurementPoints.addTo(map);

	var onomap = L.tileLayer('http://onomap-gs.noise-planet.org/geoserver/gwc/service/tms/1.0.0/noisecapture:noisecapture_area@EPSG:900913@png/{z}/{x}/{y}.png', {
	"attribution": "<a href='http://onomap-gs.noise-planet.org'>OnoMap server</a>",
	tms: true,
	zIndex: 2,
	minZoom: 14
	});

    var osm = L.tileLayer('http://a.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
        zIndex: 1
    });

    var legend = L.control({position: 'bottomleft'});

	legend.onAdd = function (map) {

		var div = L.DomUtil.create('div', 'info legend');
		div.innerHTML = "<img src='http://onomap-gs.noise-planet.org/geoserver/gwc/service/wms?REQUEST=GetLegendGraphic&VERSION=1.3.0&FORMAT=image/png&LAYER=noisecapture:noisecapture_area&legend_options=fontName:Cerdana;fontAntiAliasing:true;fontColor:0x000033;fontSize:12;dpi:80&TRANSPARENT=true'/>";
		return div;
	};

	legend.addTo(map);
    
    osm.addTo(map);
    onomap.addTo(map);

    var baseLayers = {
    "OpenStreetMap": osm
	};

	var overlays = {
		"Measurements": userMeasurementPoints,
		"Sound level (LA50)": onomap
	};

	L.control.layers(baseLayers, overlays).addTo(map);

</script>


</body>
</html>
