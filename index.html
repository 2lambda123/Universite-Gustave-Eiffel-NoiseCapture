

<html>
   <head>
      <title>NoiseCapture interactive community map</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
      <meta charset="UTF-8">
      <link rel="stylesheet" href="css/leaflet.css" />
      <link rel="stylesheet" href="css/bootstrap.min.css" />
      <link rel="stylesheet" href="css/leaflet-sidebar.css" />
      <link rel="stylesheet" href="css/languages.min.css"/>
      <link href="css/leaflet-search.min.css" rel="stylesheet"/>
      <link href="css/time_donut.css" rel="stylesheet">
      <link href="http://fontawesome.io/assets/font-awesome/css/font-awesome.css" rel="stylesheet">
      <script src="js/leaflet.js"></script>
      <style>
         body {
         padding: 0;
         margin: 0;
         }
         html, body, #map {
         height: 100%;
         font: 10pt "Helvetica Neue", Arial, Helvetica, sans-serif;
         }
         .sidepanel_donut {
         max-width: 14em;
         }
         .attribute_label {
         padding: 0px;
         margin: 0px;
         }
         .donut_block {
         display:inline-block;
         width:13em;
         }
         .logo {
           max-width: 40%;
           align-content: center;
         }
         .authorlogo {
          height: 4em;
         }
         .orglogo {
           max-width: 30%;
         }
         .centered {
           text-align: center;
         }
      </style>
   </head>
   <body>
      <div id="sidebar" class="sidebar collapsed">
         <!-- Nav tabs -->
         <div class="sidebar-tabs">
            <ul role="tablist">
               <li><a href="#home" role="tab"><i class="fa fa-home"></i></a></li>
               <li><a href="#licenses" role="tab"><i class="fa fa-copyright"></i></a></li>
               <li><a href="#contact" role="tab"><i class="fa fa-envelope"></i></a></li>
               <li><a href="#legend" role="tab"><i class="fa fa-bars"></i></a></li>
               <li><a href="#hexainfo" role="tab"><i class="fa fa-pie-chart"></i></a></li>
            </ul>
            <ul role="tablist">
               <li><a href="#settings" role="tab"><i class="fa fa-gear"></i></a></li>
            </ul>
         </div>
         <!-- Tab panes -->
         <div class="sidebar-content">
            <div class="sidebar-pane" id="home">
               <h1 class="sidebar-header">Home<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
               <div class="centered"><img src="img/noisecapture_logo.png" alt="logo" class="logo"></div>
               <p><span style="font-weight: bold;">NoiseCapture </span>is an initiative to
                  evaluate and represent the environmental noise following a participative
                  approach, with community contributors, using an Android application on a
                  smartphone. <span style="font-weight: bold;">Download the NoiseCapture
                  Android App</span> and follow the instructions on the 'Help' page on
                  your smartphone.
               </p>
               <div class="centered"><a href="https://play.google.com/store/apps/details?id=org.noise_planet.noisecapture"><img
                  style="width: 164px; height: 63px;" alt="Get it on Google Play" src="https://play.google.com/intl/en_us/badges/images/generic/en_badge_web_generic.png"></a><br>
               </div>
               <br>
               <span style="font-weight: bold;">NoiseCapture </span>is a collaboration
               between two french research laboratories, the <a title="LAE website" href="http://www.lae.ifsttar.fr">Environmental
               Acoustic Laboratory</a> (Ifsttar) and the DECIDE team of the <a title="Lab-STICC website"
                  href="http://www.lab-sticc.fr/">Lab-STICC</a> (CNRS), as a part of the
               european<b> </b><a href="http://www.energic-od.eu/">ENERGIC-OD</a><b> </b>research
               project, and is supported by the French geographic portal <a href="http://www.geopal.org">GEOPAL
               </a>of the Pays de la Loire region.<br>
               <br>
               <div class="centered">
               <a target="_blank" href="http://www.lae.ifsttar.fr"><img class="authorlogo" title="Ifsttar logo" alt="Ifsttar logo" src="img/IFSTTAR_logo_quadri.jpg"></a>
               <a target="_blank" href="http://www.lab-sticc.fr"><img class="authorlogo" title="CNRS logo" alt="CNRS logo" src="img/CNRSfr-grand.png"></a>
               <p>
               <a target="_blank" href="http://www.energic-od.eu/"><img class="orglogo" title="ENERGIC-OD logo" alt="ENERGIC-OD logo" src="img/logo_EnergicOD_HD.png"></a>
               <a target="_blank" href="https://europa.eu/"><img class="orglogo" title="Europa logo" alt="Europa logo" src="img/Logo_EUROPE.png"></a>
               <a target="_blank" href="http://www.geopal.org"><img class="orglogo" title="GEOPAL logo" alt="GEOPAL logo" src="img/Logo_GEOPAL.png"></a>
               </p>
             </div>
            </div>
            <div class="sidebar-pane" id="licenses">
               <h1 class="sidebar-header">Licenses<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
               <h3> <span style="font-weight: bold;">NoiseCapture Android App</span></h3>
               <h2><span style="font-weight: bold;"></span></h2>
               NoiseCapture Android App is a free software; you can redistribute it and/or
               modify it under the terms of the <a title="GPLv3" href="https://www.gnu.org/licenses/gpl-3.0.en.html">GNU
               General Public License</a> as published by the Free Software Foundation;
               either version 3 of the License, or (at your option) any later version.<br>
               <br>
               Contribute to the development of <span style="font-weight: bold;">NoiseCapture</span>
               <span style="font-weight: bold;">Android App</span> on GitHub:<br>
               <a target="_blank" href="https://github.com/ifsttar/noisecapture/fork"><img
                  title="Fork NoiseCapture" alt="Fork NoiseCapture" src="https://img.shields.io/github/forks/ifsttar/noisecapture.svg?style=social&amp;label=Fork"></a>
               <a target="_blank" href="https://github.com/ifsttar/noisecapture"><img title="Fork NoiseCapture"
                  alt="Fork NoiseCapture" src="https://img.shields.io/github/watchers/ifsttar/noisecapture.svg?style=social&amp;label=Watch"></a><br>
               <h3>Collected raw data</h3>
               <p>All raw data collected from the NoiseCapture Android App, i.e. the
                  DATABASE-NoiseCaptureRaw, are made available under the Open Database
                  License: <a href="http://opendatacommons.org/licenses/odbl/1.0/">http://opendatacommons.org/licenses/odbl/1.0/</a>.
                  Any rights in individual contents of the database are licensed under the
                  Database Contents License: <a href="http://opendatacommons.org/licenses/odbl/1.0/">http://opendatacommons.org/licenses/dbcl/1.0/</a>
               </p>
            </div>
            <div class="sidebar-pane" id="contact">
               <h1 class="sidebar-header">Contact<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
               <p>For any questions involving the NoiseCapture Android App and the web
                  pages, please uses the Github plateform:<br>
                  <a target="_blank" href="https://github.com/Ifsttar/NoiseCapture/issues">https://github.com/Ifsttar/NoiseCapture/issues</a>
               </p>
               <p>For any questions involving the project and the data, please contact us
                  at <a title="mailt ot: noisecapture@noise-planet.org" href="mailto:noisecapture@noise-planet.org">noisecapture(at)noise-planet.org</a>
               </p>
            </div>
            <div class="sidebar-pane" id="legend">
               <h1 class="sidebar-header">Legend<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
               <p>Noise level LA50</p>
               <img src="http://onomap-gs.noise-planet.org/geoserver/gwc/service/wms?REQUEST=GetLegendGraphic&VERSION=1.3.0&FORMAT=image/png&LAYER=noisecapture:noisecapture_area&legend_options=fontName:Times%20New%20Roman;fontAntiAliasing:true;fontColor:0x000033;fontSize:14;dpi:120&TRANSPARENT=true"/>
            </div>
            <div class="sidebar-pane" id="hexainfo">
               <h1 class="sidebar-header">Selected area<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
               <ul class="nav nav-tabs">
                  <li class="active"><a data-toggle="tab" href="#la50">LA50</a></li>
                  <!--<li><a data-toggle="tab" href="#lden">Lden</a></li>-->
                  <!--<li><a data-toggle="tab" href="#leq">Leq</a></li>-->
               </ul>
               <div class="tab-content">
                  <div id="la50" class="tab-pane fade in active">
                     <div id="areainfo"></div>
                     <div>
                        <div class="donut_block">
                           <h3 class='attribute_label'>Working days:</h3>
                           <div id="donut_working_day" class="sidepanel_donut"></div>
                        </div>
                        <div class="donut_block">
                           <h3 class='attribute_label'>Saturday:</h3>
                           <div id="donut_saturday" class="sidepanel_donut"></div>
                        </div>
                        <div class="donut_block">
                           <h3 class='attribute_label'>Sunday:</h3>
                           <div id="donut_sunday" class="sidepanel_donut"></div>
                        </div>
                     </div>
                  </div>
                  <div id="lden" class="tab-pane fade">
                     <h3>Menu 1</h3>
                     <p>Some content in menu 1.</p>
                  </div>
                  <div id="leq" class="tab-pane fade">
                     <h3>Menu 2</h3>
                     <p>Some content in menu 2.</p>
                  </div>
               </div>
            </div>
            <div class="sidebar-pane" id="settings">
               <h1 class="sidebar-header">Settings<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
               <!-- http://usrz.github.io/bootstrap-languages/ -->
               <!--  -->
               <h3>Time format language:</h3>
               <div class="btn-group dropdown">
                 <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                   <span id="time_lang" class="lang-sm lang-lbl-full" lang="en"></span> <span class="caret"></span>
                 </button>
                 <ul id="time_lang_list" class="dropdown-menu" role="menu">
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="ar"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="be"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="bg"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="cs"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="da"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="de"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="el"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="en"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="es"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="et"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="fi"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="fr"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="ga"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="hi"></span></a></li>
                   <li><a role="menuitem" tabindex="-1"><span class="lang-sm lang-lbl-full" lang="hr"></span></a></li>
                 </ul>
               </div>
               <h3>Time format zone:</h3>
               <label class="radio-inline"><input type="radio" name="tz-option"> Browser timezone</label>
<label class="radio-inline"><input onsite type="radio" name="tz-option" checked> Measurement location timezone</label>
            </div>
         </div>
      </div>
      <div id="map" class="sidebar-map"></div>

      <!-- Javascript placed at the end of the document so the pages load faster -->
      <script src="js/time_donut.js"></script>
      <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
      <script src="js/proj4.js"></script>
      <script src="js/L.TileLayer.OnoMap.js"></script>
      <script src="js/leaflet-hash.js"></script>
      <script src="js/leaflet-sidebar.js"></script>
      <script src="js/leaflet.wms.js"></script>
      <script src="js/leaflet-search.min.js"></script>
      <script src="js/moment-with-locales.min.js"></script>
      <script src="js/bootstrap.min.js"></script>


      <script>
         var map = L.map('map').setView([47.175,12.524], 5);

         var sidebar = L.control.sidebar('sidebar').addTo(map);

         var osm =  L.tileLayer('http://a.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
             attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
           });
          // http://127.0.0.1:8085/geoserver
          /*

         var onomap =  L.tileLayer.OnoMap('http://onomap-gs.noise-planet.org/geoserver/gwc/service/tms/1.0.0/noisecapture:noisecapture_area@EPSG:900913@png/{z}/{x}/{y}.png', {
             "attribution": "<a href='http://onomap-gs.noise-planet.org'>OnoMap server</a>",
             tms: true,
             minZoom: 14
           });
           */
         var onomap =  L.tileLayer.OnoMap('http://127.0.0.1:8085/geoserver/gwc/service/tms/1.0.0/noisecapture:noisecapture_area@EPSG:900913@png/{z}/{x}/{y}.png', {
             "attribution": "<a href='http://onomap-gs.noise-planet.org'>OnoMap server</a>",
             tms: true,
             minZoom: 14
           });
         var onomap_pt = L.tileLayer('http://onomap-gs.noise-planet.org/geoserver/gwc/service/tms/1.0.0/noisecapture:raw_points@EPSG:900913@png/{z}/{x}/{y}.png', {
             "attribution": "<a href='http://onomap-gs.noise-planet.org'>OnoMap server</a>",
             tms: true,
             minZoom: 14
           });
         var onomap_heat =  L.WMS.source(
                                     "http://onomap-gs.noise-planet.org:80/geoserver/noisecapture/wms",
                                     {
                                         "format": "image/png",
                                         "transparent": "true",
                                         "attribution": "<a href='http://onomap-gs.noise-planet.org'>OnoMap server</a>",
                                         "tiled": false,
                                         "identifyLayers" : [],
                                         "maxZoom": 13
                                     }
                             );
         var onomap_heat_layer = onomap_heat.getLayer("noisecapture:heatmap_raw_points_density");
         //onomap_heat_layer.setOpacity(0.7);

         L.control.scale({'position':'bottomright','metric':true,'imperial':false}).addTo(map);

         new L.Control.Search({ url: 'https://nominatim.openstreetmap.org/search?format=json&q={s}', jsonpParam: 'json_callback', propertyName: 'display_name',    propertyLoc: ['lat','lon'],    markerLocation: true,    autoType: false,
    autoCollapse: true,
    minLength: 2,
    zoom:15
}).addTo(map);

         map.addLayer(osm)
         map.addLayer(onomap)
         map.addLayer(onomap_heat_layer)

         var baseLayers = {"OpenStreetMap" : osm};

         L.control.layers(baseLayers, {"NoiseCapture areas" : onomap, "Density of measures" : onomap_heat_layer, "Location of measures" : onomap_pt}).addTo(map);

         var hash = new L.Hash(map);

         var weekdonut = initTimeDonut("donut_working_day");
         var saturdaydonut = initTimeDonut("donut_saturday");
         var sundaydonut = initTimeDonut("donut_sunday");


      </script>
   </body>
</html>
